持续集成jenkins入门
持续集成(Continuous integration,简称CI)
1.什么是持续集成?
软件集成就是用一种较好的方式,使多种软件的功能集成到一个软件里,或是把软件的各部分组合在一起.如果项目开发的规模较小,且对外部系统的依赖很小,那么软件集成不是问题.但是随着软件项目复杂度的增加,会对集成和确保软件组件能够在一起工作提出来更多的要求->更早集成,常集成.早集成,频繁的集成能够帮助项目开发者在早期发现项目风险和质量问题,越到后期发现的问题,解决的成本越高,从而有可能导致项目延期或项目失败
2.定义
持续集成是一种软件开发实践,即团队开发成员经常集成他们的工作,通常每个成员每天至少集成一次,也就意味着每天可能会发生多次集成.每次集成都通过自动化的构建(包括编译,发布,自动化测试)来验证,从而尽快地发现集成错误.
3.什么是Jenkins?
jenkins主要用于监视执行重复工作,如建立一个软件项目或工作运行的计划任务
当前Jenkins关注以下两个工作
	不断地进行项目的构建/测试软件:就像CruiseControl或DamageControl.Jenkins提供了一个易于使用的所谓的持续集成系统,使开发人员更容易修改整合到项目中,并使它更容易为用户获得一个新的版本.自动连续生成提高了生产效率
	监控外部运行的作业:如计划任务作业和Qrocmail的工作,即使是那些在远程机器上运行的计划任务.Jenkins生成这些日志并且很容易让你注意到错误的出现
14.1环境搭建
Jenkins是基于Java开发的一种持续集成工具,所以Jenkins的运行需要Java环境.
1.安装Tomcat
Tomcat是针对Java的一个开源中间件服务器(容器),基于Java Web的项目需要借助Tomcat才能运行起来
Tomcat官方网站:http://tomcat.apache.org/
通常将需要运行的应用放到webapps/目录下,进入bin/目录下,双击startup.bat,启动Tomcat服务器
2.安装Jenkins
Jenkins官方网站:http://jenkins-ci.org/
根据自己的系统选择下载
指定安装到Tomcat的webapps/目录下
3.运行Jenkins
进入Tomcat的bin/目录下启动starup.bat,通过浏览器访问:http://localhost:8080
14.2 创建任务
jenkins提供了四种类型的任务
1)构建一个自由风格的任务
jenkins主要功能.jenkins会结合任何SCM和任何构建系统来构建你的项目,甚至可以构建软件以外的系统
2)构建一个maven项目
jenkins会利用你的POM文件,这样可以大大减轻构建配置
3)构建一个多配置项目
适用于多配置项目,例如多环境测试,平台指定构建等
4)监视一个外部的任务
这个类型的任务允许你记录执行在外部jenkins的任务,任务可以运行在远程机器上.这可以让jenkins作为你所有自动构建系统的控制面板


1.丢弃旧的构建
主要用来配置构建历史保存的几个版本,每次执行构建都会产生日志.日志的生成会占用一定的磁盘空间,通过勾选此选项就可以设置保持构建天数和构建次数
2.安静期
如果设置次选项,则一个计划中的欧构建在开始之前需要等待选项中设置的秒数,这对下面的情况非常有用:
    合并多封CVS变更通知邮件为一封(当一次提交跨越多个目录时,一些CVS的变更日志邮件发生脚本会接二连三地生成多封通知邮件)
    如果你的编码风格导致你更改一个逻辑需要几次CVS/SVN操作,那么设置一个较长时间的等待会防止jenkins因过早构建而失败
    节省构建.如果你的jenkins有太多且高频率的构建,则设置长时间的等待会舒缓这些构建
3.重试次数
.......
略
....

14.4 定时执行构建
定制执行python脚本有很多方式,例如windows系统自带的添加任务计划,Linux系统的at命令和crontab命令都可以很灵活地设置定时任务.
通过jenkins实现定时任务只是其中的一种方法
jenkins中的配置-->构建触发器-->勾选定时构建
此处的定时任务的格式遵循的cron的语法(可以与cron的语法有轻微的差异).具体格式,每行包含五个字段,通过Tab或空格分隔
    cron语法格式
    字段              说明
    MINUTE          Minutes within the hour(0-59)
    HOUR            The hour of the day(0-23)
    DOM             The day of the month(1-31)
    MONTH           The month(1-12)
    DOW             The day of the week(0-7)where0and7 are Sunday


    crontab格式说明
    *       *      *       *       *       command
    0-59    0-23    1-31    1-12    0-7     需要执行的命令
                                    星期几
                            月份
                    几号
            小时
    分钟
在以上各个字段中,还可以使用一下特殊字符
星号*: 代表所有可能的值.例如,month字段如果是星号,则表示在满足其他字段的制约条件后每月都执行该命令操作
逗号,: 可以用逗号隔开的值指定一个列表范围.例如"1,2,5,7,8,9"
中杠-: 可以用整数之间的中杠表示一个整数范围.例如,"2-6"表示"2,3,4,5,6"
正斜线/: 可以用正斜线指定时间的间隔频率.例如,"0-23/2"表示每两小时执行一次.同时正斜线可以和星号一起使用,例如,*/10,如果用在minute字段,表示每十分钟执行一次
实例:
假如,周一至周五每天早上4点跑自动化测试用例:
m       H       Dom     Mon     Dow     command
分钟    小时     天      月      星期     命令/脚本
*       4       *       *       1-5     python /home/pyse/test.py
假如,每周一和周三下午6点半运行自动化测试用例
m       H       Dom     Mon     Dow     command
分钟    小时     天      月       星期    命令/脚本
30      18      *       *       1,3     python /home/pyse/test.py
jenkins的定时任务设置上,在"Build periodically"选项中只需设置脚本的执行日期和时间
例二:30 18 * * 1,3
本章小结
jenkins初步了解
CVS和SVN等版本控制工具结合,使版本工具发生更新时进行项目的构建
Jenkins分布式构建,类似与Selenium Grid的功能
Jenkins可以配置Master/Slave架构,Master提供Web接口让用户来管理job和slave,job可以运行在master本金或者被分配到slave上运行,一个master可以关联多个slave为不同的job或相同的job的不同配置服务

